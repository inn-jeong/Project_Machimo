<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        input::-webkit-inner-spin-button {
            appearance: none;
            -moz-appearance: none;
            -webkit-appearance: none;
        }
    </style>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>
        function Go() {


        }


        $(document).ready(function () {
            $("#compare").click(function (event) {
                event.preventDefault();  // 폼 제출을 방지합니다.

                var bidsInput = $('input[name="bids"]').val();
                var productIdInput = $('input[name="productId"]').val();
                var bidsHistoryInput = $('input[name="bidsHistory"]').prop('checked');
                var firstPriceInput = $('input[name="firstPrice"]').val();

                $.ajax({
                    url: "/auction/action-list/amountCheck",
                    type: "POST",
                    contentType: "application/json",
                    data: JSON.stringify({
                        bids: bidsInput,
                        productId: productIdInput,
                        bidsHistory: bidsHistoryInput,
                        firstPrice: firstPriceInput
                    }),
                    success: function (response) {
                    },
                    error: function (xhr, status, error) {
                        // 요청이 실패했을 때의 처리 로직
                        console.log("tlqkf")
                        alert("최고 금액보다 높은 금액을 입력해주세요.")
                    }
                });
            });
        });
    </script>
</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous">

</script>
<body>
<th:block th:replace="fragments/header :: headerFragment"></th:block>
<!-- NAV -->


<!-- <button type="button" class="btn btn-success btn-lg" data-bs-toggle="modal"
                data-bs-target="#staticBackdrop">

        </button> -->
<main>

    <div class="container">

        <div class="mb-3 me-md-auto">
            <div class="row">
                <div class="col">
                    <div id="carouselExampleFade" class="carousel slide carousel-fade">
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img src="/img/1.jpg" class="d-block w-100" alt="">
                            </div>
                            <div class="carousel-item active-table-tab">
                                <img src="/img/2.jpg" class="d-block w-100" alt="...">
                            </div>
                            <div class="carousel-item active-table-tab">
                                <img src="/img/3.jpg" class="d-block w-100" alt="...">
                            </div>
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleFade"
                                data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleFade"
                                data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>

                <div class="col">
                    <div class="h2">
                        제품 제목
                    </div>
                    <div>
                        <span>경매 종료일</span>
                        <span th:text="${endDate}"></span>
                    </div>
                    <div>
                        <b class="h4" th:unless="${hasBidHistory}"
                           data-th-text="${#numbers.formatInteger(aList.highestBid(), 3, 'COMMA') + '원'}">가격</b>
                        <b class="h4" th:if="${hasBidHistory}"
                           data-th-text="${#numbers.formatInteger(pView.pBPrice(), 3, 'COMMA') + '원'}">가격</b>

                    </div>

                    <div>
                        상품 설명 어쩌구 저쩌구 블라블라아아앙아ㅏ아아아아아아아앙아아아아아아아아아아아아아아아아아아아아아아아아아아아앙
                    </div>
                    <div class="me-auto py-4">
                        <button th:if="${pView.pSaleType()==0}" type="button" class="btn btn-success btn-lg mb w-50"
                                data-bs-toggle="modal"
                                data-bs-target="#staticBackdrop">
                            입찰하기
                        </button>
                        <button th:if="${pView.pSaleType()==1}" type="button" class="btn btn-success btn-lg mb w-50">
                            즉시구매
                        </button>
                    </div>
                    <div class="me-auto py-2">
                        <button type="button" class="btn btn-secondary btn-lg mb-1 w-50" data-bs-toggle="modal"
                                data-bs-target="#staticBackdrop">
                            장바구니
                        </button>
                    </div>
                </div>
                <div class="col-3">
                    <div th:each="bShow:${bList}">
                        <span th:text="${bShow.amount()}"></span>
                    </div>
                </div>

            </div>
        </div>
    </div>

</main>
</div>
<!--&#45;&#45;                모달 -->
<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
                <form action="amountCheck" method="post">
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">

                <h1 class=" modal-title fs-5 " id="staticBackdropLabel">입찰가 입력</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body ">
                <div class="input-group mb-3">
                    <input type="text" name="bids" class="form-control" aria-label="Won amount (with dot and two decimal places)">
                    <span class="input-group-text">₩</span>
                    <input name="productId" type="hidden" th:value="${pView.productsId()}">
                    <input name="bidsHistory" type="hidden" th:value="${pView.productsId()}">
                    <input name="firstPrice" type="hidden" th:value="${pView.pBPrice()}">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                <button id="compare" type="button"  class="btn btn-primary">입찰</button>
            </div>
        </div>
    </div>
                    </form>
</div>
<th:block th:replace="fragments/footer:: footerFragment"></th:block>
</body>
</html>