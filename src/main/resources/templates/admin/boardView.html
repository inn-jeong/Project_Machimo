<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>boardView</title>
  <!--header-->
  <div th:replace="fragments/header.html :: fragment-header"></div>
</head>
<body>
  <div class="container p-5 mb-4">
    <div class="row py-3 border-bottom m-3">
      <h2 class="m-0 fw-bold text-secondary" th:if="${boardView.bCategory == '공지'}" th:text="'['+ ${boardView.bCategory} +']'"></h2>
      <h2 class="m-0 fw-bold text-secondary" th:if="${boardView.bCategory == '문의'}" th:text="'['+ ${boardView.inquiryCategory} +']'"></h2>
    </div>
    <div class="row pt-4 m-3">
      <div class="col">
        <h3 class="display-7 fw-bold" th:text="'제목: '+ ${boardView.bTitle}"></h3>
      </div>
    </div>
    <div class="row border-bottom pb-3 m-3">
      <div class="col">
        <h5 class="fw-medium fs-5" th:text="'작성자: '+ ${boardView.bWriter}"></h5>
        <h5 class="fs-6" th:text="'작성일자: ' + ${#dates.format(boardView.bDate, 'YYYY-MM-DD')}"></h5>
      </div>
    </div>
    <div class="row">
      <div class="col fs-5 m-4">
        <p th:text="'내용: ' + ${boardView.bContent}"></p>
      </div>
    </div>
    <div class="d-flex gap-2 justify-content-center py-5">
      <button class="btn btn-outline-secondary d-inline-flex align-items-center" type="button">
        <a href="/admin/boardList">목록보기</a>
      </button>

      <!--admin일때만 수정, 삭제 버튼 활성화-->
      <div th:if="${session.user.userId == 1}">
        <button class="btn btn-outline-secondary d-inline-flex align-items-center" type="button">
          <a th:href="@{/admin/boardModifyView/{boardId}(boardId=${boardView.boardId})}">수정</a>
        </button>

        <button class="btn btn-danger rounded-pill px-3" type="button" th:onclick="'boardDelete(\''+${boardView.boardId}+'\')'">
          삭제
        </button>

      </div>

    </div>
  </div>
  <!--footer-->
  <div th:replace="fragments/footer.html :: fragment-footer"></div>
</body>
</html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script th:inline="javascript">
  function boardDelete(boardId){
    console.log("@# boardDelete")

    var chk = confirm("정말 삭제하시겠습니까?");
    if(chk){
      $.ajax({
        url:'/admin/boardDelete',
        method: 'POST',
        data: {
          'boardId':boardId
        },
        success: function (response){
          if(response === "deleteOk"){
            alert("게시물이 삭제되었습니다.")
            location.href="/admin/boardList";
          }
          else{
            alert("게시물 삭제에 실패했습니다.")
          }
        },
        error: function (xhr, status, error){
          alert("에러 발생: "+error);
        }
      });
    }
  }
</script>
