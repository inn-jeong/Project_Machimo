<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.project_machimo.productEnroll.dao.EnrollMapper">


    <insert id="write" parameterType="com.example.project_machimo.productEnroll.dto.ProductDto" >
        INSERT INTO products
        (product_id, c_id, c_id2, user_id, p_name, p_info, p_created_at, p_sale_type, p_account, p_bank, p_address, p_address_sub, p_addr_postcode)
        VALUES (
        (SELECT COALESCE(MAX(product_id), 0) + 1 FROM products),
        #{cId}, #{cId2}, #{userId}, #{pName}, #{pInfo}, SYSDATE, #{pSaleType}, #{pAccount},  #{pBank}, #{pAddress}, #{pAddressSub}, #{pAddrPostcode}
        )
    </insert>

    <select id="getCategories" resultType="com.example.project_machimo.productEnroll.dto.CategoryVO">
        select c_id, c_name, c_id2 from category where c_id2 is null
    </select>

    <select id="getSubCategories" resultType="com.example.project_machimo.productEnroll.dto.CategoryVO">
        select c_id, c_name, c_id2 from category where c_id2 = #{cId2}
    </select>

</mapper>